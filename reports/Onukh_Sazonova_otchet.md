#Оценка эффективности обработки данных датчика КГР с помощью AutoML TPOT
##Введение
Электродермальная активность (ЭДА или КГР) — это надежный физиологический индикатор эмоционального возбуждения и стресса, измеряемый через изменение электропроводности кожи. Автоматическая количественная оценка стрессового состояния на основе КГР критически важна для приложений в области психофизиологии, аффективных вычислений, мониторинга психического здоровья и человеко-компьютерного взаимодействия. Классический анализ КГР требует экспертных знаний и трудоемок. AutoML (автоматизированное машинное обучение) предлагает путь к созданию эффективных классификационных моделей без ручного подбора алгоритмов и их параметров.

###Постановка задачи
Цель: построить бинарный классификатор для прогнозирования состояния стресса у пациента на основе агрегированных статистических признаков, извлеченных из временных окон сигнала КГР.

###Основные шаги:

Использовать датасет показателей КГР для 22 пациентов в состояниях покоя (0) и стресса (1).

Провести агрегацию сырых данных в 528 временных окон и извлечь 14 первичных признаков на окно.

Агрегировать данные на уровне пациента, создав 44 финальных записи (по 2 на пациента) с 36 статистическими признаками.

Применить автоматический поиск моделей с помощью TPOT (Tree-based Pipeline Optimization Tool) в режиме строгой кросс-валидации Leave-One-Subject-Out (LOSO).

Проанализировать эффективность подхода, стабильность выбора алгоритмов и интерпретировать полученные результаты.

##Данные
###Источник и структура

Набор данных: Измерения КГР (кожно-гальванической реакции) для 22 пациентов.

Протокол: Для каждого пациента зарегистрированы сигналы в двух состояниях: покой и индуцированный стресс.

Первичная обработка: Исходный сигнал разбит на 528 временных окон (по 12 окон на состояние для каждого пациента).

Итоговый датасет для моделирования: 44 записи (22 пациента × 2 состояния), каждая описывается 39 признаками (36 агрегированных признаков ЭДА + subject_id, stress, n_windows).

###Баланс классов и особенности

Идеальный баланс: По 264 окна (50%) и по 2 записи на пациента для каждого класса (stress=0 и stress=1).

Ключевая особенность: Высокая межиндивидуальная вариабельность. Как видно из статистики, базовый уровень ЭДА (mean) сильно различается между пациентами (напр., subject_id=2 имеет mean ~6.3, а subject_id=8 — ~0.5). Это делает задачу классификации сложной для глобальной модели и требует персонализированного подхода или строгой схемы валидации.

Схема валидации: Для избежания «утечки данных» и корректной оценки обобщающей способности применена Leave-One-Subject-Out (LOSO) кросс-валидация. На каждой итерации модель обучается на данных 21 пациента и тестируется на одном оставленном пациенте. Это имитирует реальный сценарий предсказания для нового, ранее не виденного человека.

##Модель и процесс
###Выбор подхода: AutoML (TPOT)
Для решения задачи использован TPOT — фреймворк AutoML, который применяет генетическое программирование для автоматического поиска и оптимизации полных конвейеров машинного обучения (предобработка + модель). TPOT:

Перебирает различные алгоритмы классификации (от линейных моделей до ансамблевых методов).

Комбинирует их с методами предобработки данных (масштабирование, отбор признаков).

Оптимизирует гиперпараметры выбранных алгоритмов.

Эволюционирует популяцию конвейеров, отбирая лучшие по заданной метрике (по умолчанию — accuracy).

###Конфигурация поиска
В данном исследовании использовался ограниченный, но целевой поиск:

Метод валидации: LOSO (22 фолда, по одному на пациента).

Параметры TPOT: generations=2, population_size=5. Это быстрый поиск, нацеленный на демонстрацию принципиальной возможности, а не на исчерпывающую оптимизацию.

Целевая метрика: Точность (Accuracy). Выбор оправдан идеальным балансом классов в данных.

###Процесс обучения

Подготовка: Данные агрегированы до уровня пациента (44 образца, 36 признаков).

LOSO-Цикл: Для каждого из 22 пациентов:

TPOT запускает генетический поиск оптимального конвейера на данных 21 пациента.

Лучшая найденная модель оценивается на данных оставленного пациента.

Агрегация: Финализируется 22 лучших модели (по одной для каждого фолда LOSO) и вычисляется средняя точность по всем фолдам.

##Результаты
###Метрики

Средняя точность (LOSO): 0.545 ± 0.257

Интерпретация: Модель демонстрирует скромное улучшение над случайным угадыванием (50%). Однако высокое стандартное отклонение (±0.257) указывает на крайнюю неоднородность результатов между разными пациентами. Для некоторых пациентов (напр., 5, 12, 18) точность достигала 0.708-1.000, в то время как для других (напр., 17) падала до 0.333.

###Матрица неточностей (усредненная логика):
Поскольку модель в среднем дает 54.5% правильных ответов, это означает, что она верно классифицирует примерно 11 из 20 состояний (покой/стресс) для нового пациента, что близко к уровню слабого, но существующего сигнала.

###Анализ выбранных алгоритмов
TPOT продемонстрировал разнообразие в выборе лучших моделей для разных подмножеств данных (разных фолдов LOSO):

LGBMClassifier & AdaBoostClassifier: По 4 раза (по 18%) — градиентный бустинг чаще всего оказывался эффективным.

Разнообразие алгоритмов: Остальные 14 фолдов распределились между RandomForest, SGD, наивным байесом, деревьями решений и др. Это указывает на отсутствие единственного "универсального" алгоритма, который бы идеально работал для всех пациентов из-за высокой индивидуальной вариабельности данных.

###Важность признаков и интерпретация

Косвенный анализ: Прямая оценка важности признаков не проводилась в рамках данного запуска TPOT. Однако, исходя из физиологии, наиболее информативными должны быть признаки, описывающие динамику и амплитуду реакции (например, std*\*, iqr*\*, max_min), а не просто средний уровень (mean_mean), который сильно индивидуален.

Подтверждение сложности задачи: Результат в 54.5% точности и большой разброс по пациентам подтверждает, что различие между покоем и стрессом по агрегированным статистикам КГР не является тривиальным и сильно выраженным на межсубъектном уровне. Модель не нашла сильных универсальных паттернов.

##Выводы
###Достигнутые результаты

Автоматизация: TPOT успешно автоматизировал процесс построения и оптимизации 22 различных классификационных конвейеров в рамках строгой LOSO-схемы валидации.

Реалистичная оценка: Применение LOSO дало реалистичную и строгую оценку качества (54.5%), исключающую оптимистичное смещение.

Выявление вариабельности: Исследование наглядно продемонстрировало ключевую проблему в психофизиологическом анализе — высокую межиндивидуальную вариабельность сигналов, требующую персонализированных подходов.

###Ограничения текущего подхода

Умеренная точность: Итоговая точность 54.5% недостаточна для практического применения.

Признаковое пространство: Использованные 36 агрегированных статистик могут быть недостаточно информативными или содержать избыточность.

Объем данных: 44 финальных образца — очень малый набор данных для обучения обобщающей модели, особенно с учетом высокой вариабельности.

Конфигурация TPOT: Ограниченный поиск (2 поколения) не позволил TPOT в полной мере раскрыть свой потенциал по оптимизации.

###Практическое значение
Несмотря на скромную точность, исследование подтвердило принципиальную возможность и наметило четкий путь для автоматизированной классификации стресса по КГР. После реализации улучшений (персонализация, расширение признаков) подобная система может быть встроена в:

Носимые устройства для мониторинга уровня стресса и профилактики выгорания.

Биологическую обратную связь (БОС) для обучения саморегуляции.

Интерфейсы "мозг-компьютер" и аффективные интерфейсы для оценки эмоционального состояния пользователя.

Работа представляет собой важный первый шаг в применении современных методов AutoML к сложной задаче психофизиологической классификации, где индивидуализация данных является критическим фактором успеха.
